use crate::emulator::addressing::AddressMode;
use crate::emulator::instructions::opcodes::*;
use crate::emulator::Emulator;
use crate::memory::Memory;

impl<C: Memory> Emulator<C> {
    pub(crate) fn execute(&mut self, instruction: u8) {
        match instruction {
            ADC::IMMEDIATE => self.adc(AddressMode::Immediate),
            ADC::ZEROPAGE => self.adc(AddressMode::ZeroPage),
            ADC::ZEROPAGEX => self.adc(AddressMode::ZeroPageX),
            ADC::ABSOLUTE => self.adc(AddressMode::Absolute),
            ADC::ABSOLUTEX => self.adc(AddressMode::AbsoluteX),
            ADC::ABSOLUTEY => self.adc(AddressMode::AbsoluteY),
            ADC::INDEXEDINDIRECT => self.adc(AddressMode::IndexedIndirect),
            ADC::INDIRECTINDEXED => self.adc(AddressMode::IndirectIndexed),
            AND::IMMEDIATE => self.and(AddressMode::Immediate),
            AND::ZEROPAGE => self.and(AddressMode::ZeroPage),
            AND::ZEROPAGEX => self.and(AddressMode::ZeroPageX),
            AND::ABSOLUTE => self.and(AddressMode::Absolute),
            AND::ABSOLUTEX => self.and(AddressMode::AbsoluteX),
            AND::ABSOLUTEY => self.and(AddressMode::AbsoluteY),
            AND::INDEXEDINDIRECT => self.and(AddressMode::IndexedIndirect),
            AND::INDIRECTINDEXED => self.and(AddressMode::IndirectIndexed),
            ASL::ACCUMULATOR => self.asl_acc(),
            ASL::ZEROPAGE => self.asl_mem(AddressMode::ZeroPage),
            ASL::ZEROPAGEX => self.asl_mem(AddressMode::ZeroPageX),
            ASL::ABSOLUTE => self.asl_mem(AddressMode::Absolute),
            ASL::ABSOLUTEX => self.asl_mem(AddressMode::AbsoluteX),
            BCC::RELATIVE => self.bcc(),
            BCS::RELATIVE => self.bcs(),
            BEQ::RELATIVE => self.beq(),
            BIT::ZEROPAGE => self.bit(AddressMode::ZeroPage),
            BIT::ABSOLUTE => self.bit(AddressMode::Absolute),
            BMI::RELATIVE => self.bmi(),
            BNE::RELATIVE => self.bne(),
            BPL::RELATIVE => self.bpl(),
            BRK::IMMEDIATE => self.brk(),
            BVC::RELATIVE => self.bvc(),
            BVS::RELATIVE => self.bvs(),
            CLC::IMPLIED => self.clc(),
            CLD::IMPLIED => self.cld(),
            CLI::IMPLIED => self.cli(),
            CLV::IMPLIED => self.clv(),
            CMP::IMMEDIATE => self.cmp(AddressMode::Immediate),
            CMP::ZEROPAGE => self.cmp(AddressMode::ZeroPage),
            CMP::ZEROPAGEX => self.cmp(AddressMode::ZeroPageX),
            CMP::ABSOLUTE => self.cmp(AddressMode::Absolute),
            CMP::ABSOLUTEX => self.cmp(AddressMode::AbsoluteX),
            CMP::ABSOLUTEY => self.cmp(AddressMode::AbsoluteY),
            CMP::INDEXEDINDIRECT => self.cmp(AddressMode::IndexedIndirect),
            CMP::INDIRECTINDEXED => self.cmp(AddressMode::IndirectIndexed),
            CPX::IMMEDIATE => self.cpx(AddressMode::Immediate),
            CPX::ZEROPAGE => self.cpx(AddressMode::ZeroPage),
            CPX::ABSOLUTE => self.cpx(AddressMode::Absolute),
            CPY::IMMEDIATE => self.cpy(AddressMode::Immediate),
            CPY::ZEROPAGE => self.cpy(AddressMode::ZeroPage),
            CPY::ABSOLUTE => self.cpy(AddressMode::Absolute),
            DEC::ZEROPAGE => self.dec(AddressMode::ZeroPage),
            DEC::ZEROPAGEX => self.dec(AddressMode::ZeroPageX),
            DEC::ABSOLUTE => self.dec(AddressMode::Absolute),
            DEC::ABSOLUTEX => self.dec(AddressMode::AbsoluteX),
            DEX::IMPLIED => self.dex(),
            DEY::IMPLIED => self.dey(),
            EOR::IMMEDIATE => self.eor(AddressMode::Immediate),
            EOR::ZEROPAGE => self.eor(AddressMode::ZeroPage),
            EOR::ZEROPAGEX => self.eor(AddressMode::ZeroPageX),
            EOR::ABSOLUTE => self.eor(AddressMode::Absolute),
            EOR::ABSOLUTEX => self.eor(AddressMode::AbsoluteX),
            EOR::ABSOLUTEY => self.eor(AddressMode::AbsoluteY),
            EOR::INDEXEDINDIRECT => self.eor(AddressMode::IndexedIndirect),
            EOR::INDIRECTINDEXED => self.eor(AddressMode::IndirectIndexed),
            INC::ZEROPAGE => self.inc(AddressMode::ZeroPage),
            INC::ZEROPAGEX => self.inc(AddressMode::ZeroPageX),
            INC::ABSOLUTE => self.inc(AddressMode::Absolute),
            INC::ABSOLUTEX => self.inc(AddressMode::AbsoluteX),
            INX::IMPLIED => self.inx(),
            INY::IMPLIED => self.iny(),
            JMP::ABSOLUTE => self.jmp(AddressMode::Absolute),
            JMP::INDIRECT => self.jmp(AddressMode::Indirect),
            JSR::IMPLIED => self.jsr(),
            LDA::IMMEDIATE => self.lda(AddressMode::Immediate),
            LDA::ZEROPAGE => self.lda(AddressMode::ZeroPage),
            LDA::ZEROPAGEX => self.lda(AddressMode::ZeroPageX),
            LDA::ABSOLUTE => self.lda(AddressMode::Absolute),
            LDA::ABSOLUTEX => self.lda(AddressMode::AbsoluteX),
            LDA::ABSOLUTEY => self.lda(AddressMode::AbsoluteY),
            LDA::INDEXEDINDIRECT => self.lda(AddressMode::IndexedIndirect),
            LDA::INDIRECTINDEXED => self.lda(AddressMode::IndirectIndexed),
            LDX::IMMEDIATE => self.ldx(AddressMode::Immediate),
            LDX::ZEROPAGE => self.ldx(AddressMode::ZeroPage),
            LDX::ZEROPAGEY => self.ldx(AddressMode::ZeroPageY),
            LDX::ABSOLUTE => self.ldx(AddressMode::Absolute),
            LDX::ABSOLUTEY => self.ldx(AddressMode::AbsoluteY),
            LDY::IMMEDIATE => self.ldy(AddressMode::Immediate),
            LDY::ZEROPAGE => self.ldy(AddressMode::ZeroPage),
            LDY::ZEROPAGEX => self.ldy(AddressMode::ZeroPageX),
            LDY::ABSOLUTE => self.ldy(AddressMode::Absolute),
            LDY::ABSOLUTEX => self.ldy(AddressMode::AbsoluteX),
            LSR::ACCUMULATOR => self.lsr_acc(),
            LSR::ZEROPAGE => self.lsr_mem(AddressMode::ZeroPage),
            LSR::ZEROPAGEX => self.lsr_mem(AddressMode::ZeroPageX),
            LSR::ABSOLUTE => self.lsr_mem(AddressMode::Absolute),
            LSR::ABSOLUTEX => self.lsr_mem(AddressMode::AbsoluteX),
            NOP::IMPLIED => self.nop(),
            ORA::IMMEDIATE => self.ora(AddressMode::Immediate),
            ORA::ZEROPAGE => self.ora(AddressMode::ZeroPage),
            ORA::ZEROPAGEX => self.ora(AddressMode::ZeroPageX),
            ORA::ABSOLUTE => self.ora(AddressMode::Absolute),
            ORA::ABSOLUTEX => self.ora(AddressMode::AbsoluteX),
            ORA::ABSOLUTEY => self.ora(AddressMode::AbsoluteY),
            ORA::INDEXEDINDIRECT => self.ora(AddressMode::IndexedIndirect),
            ORA::INDIRECTINDEXED => self.ora(AddressMode::IndirectIndexed),
            PHA::IMPLIED => self.pha(),
            PHP::IMPLIED => self.php(),
            PLA::IMPLIED => self.pla(),
            PLP::IMPLIED => self.plp(),
            ROL::ACCUMULATOR => self.rol_acc(),
            ROL::ZEROPAGE => self.rol_mem(AddressMode::ZeroPage),
            ROL::ZEROPAGEX => self.rol_mem(AddressMode::ZeroPageX),
            ROL::ABSOLUTE => self.rol_mem(AddressMode::Absolute),
            ROL::ABSOLUTEX => self.rol_mem(AddressMode::AbsoluteX),
            ROR::ACCUMULATOR => self.ror_acc(),
            ROR::ZEROPAGE => self.ror_mem(AddressMode::ZeroPage),
            ROR::ZEROPAGEX => self.ror_mem(AddressMode::ZeroPageX),
            ROR::ABSOLUTE => self.ror_mem(AddressMode::Absolute),
            ROR::ABSOLUTEX => self.ror_mem(AddressMode::AbsoluteX),
            RTI::IMPLIED => self.rti(),
            RTS::IMPLIED => self.rts(),
            SBC::IMMEDIATE => self.sbc(AddressMode::Immediate),
            SBC::ZEROPAGE => self.sbc(AddressMode::ZeroPage),
            SBC::ZEROPAGEX => self.sbc(AddressMode::ZeroPageX),
            SBC::ABSOLUTE => self.sbc(AddressMode::Absolute),
            SBC::ABSOLUTEX => self.sbc(AddressMode::AbsoluteX),
            SBC::ABSOLUTEY => self.sbc(AddressMode::AbsoluteY),
            SBC::INDEXEDINDIRECT => self.sbc(AddressMode::IndexedIndirect),
            SBC::INDIRECTINDEXED => self.sbc(AddressMode::IndirectIndexed),
            SEC::IMPLIED => self.sec(),
            SED::IMPLIED => self.sed(),
            SEI::IMPLIED => self.sei(),
            STA::ZEROPAGE => self.sta(AddressMode::ZeroPage),
            STA::ZEROPAGEX => self.sta(AddressMode::ZeroPageX),
            STA::ABSOLUTE => self.sta(AddressMode::Absolute),
            STA::ABSOLUTEX => self.sta(AddressMode::AbsoluteX),
            STA::ABSOLUTEY => self.sta(AddressMode::AbsoluteY),
            STA::INDEXEDINDIRECT => self.sta(AddressMode::IndexedIndirect),
            STA::INDIRECTINDEXED => self.sta(AddressMode::IndirectIndexed),
            STX::ZEROPAGE => self.stx(AddressMode::ZeroPage),
            STX::ZEROPAGEY => self.stx(AddressMode::ZeroPageY),
            STX::ABSOLUTE => self.stx(AddressMode::Absolute),
            STY::ZEROPAGE => self.sty(AddressMode::ZeroPage),
            STY::ZEROPAGEX => self.sty(AddressMode::ZeroPageX),
            STY::ABSOLUTE => self.sty(AddressMode::Absolute),
            TAX::IMPLIED => self.tax(),
            TAY::IMPLIED => self.tay(),
            TSX::IMPLIED => self.tsx(),
            TXA::IMPLIED => self.txa(),
            TXS::IMPLIED => self.txs(),
            TYA::IMPLIED => self.tya(),
            _ => panic!("Unknown instruction {:x}", instruction),
        }
    }
}
